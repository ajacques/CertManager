<% url = Rails.application.routes.url_helpers %>

var urls = {};
(function(root) {
  root.fetch_key_path = function () {
    return '<%= url.import_from_url_certificates_path %>';
  };

  function serialize(obj) {
    var str = [];
    for(var p in obj)
      str.push(encodeURIComponent(p) + "=" + encodeURIComponent(obj[p]));
    return str.join("&");
  }

  root.certificate_path = function (id, format) {
    if (typeof format !== "undefined") {
      format = "." + format;
    } else {
      format = "";
    }
    if (arguments.length >= 2) {
      format += '?';
      format += serialize(arguments[2]);
    }
    return '<%= url.certificates_path %>/' + id + format;
  };
}).call(null, urls);